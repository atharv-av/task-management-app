(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){"use strict";a.r(t);a(42);var s=a(0),n=a.n(s),l=a(12),r=a.n(l),o=(a(80),a(81),a(39)),i=a(40);var c=e=>n.a.createElement("button",{className:"deleteTaskButton",type:"button",onClick:()=>e.deleteTask(e.taskID)},n.a.createElement(o.a,{icon:i.a}));a(86);var d=e=>{const{task_id:t,task_title:a,task_desc:s,task_completed:l,task_scheduled_dt:r,priority_desc:o}=e.task,i=r?r.substring(0,10):"",d="High"===o?"task__priority--high":"task__priority";return n.a.createElement("div",{className:"task"},n.a.createElement("form",{id:t,autoComplete:"off"},n.a.createElement("input",{className:"task__title",type:"text",name:"task_title",value:a,onChange:e.handleTaskUpdate,onBlur:e.putTaskUpdate}),n.a.createElement("input",{className:"task__completed",type:"checkbox",name:"task_completed",checked:l,onChange:e.handleTaskUpdate,onBlur:e.putTaskUpdate}),n.a.createElement("textarea",{placeholder:"Description",className:"task__desc",name:"task_desc",rows:"3",cols:"20",value:s,onChange:e.handleTaskUpdate,onBlur:e.putTaskUpdate}),n.a.createElement("input",{className:"task__scheduledDt",type:"date",name:"task_scheduled_dt",value:i,onChange:e.handleTaskUpdate,onBlur:e.putTaskUpdate}),n.a.createElement("select",{className:d,name:"priority_desc",value:o,onChange:e.handleTaskUpdate,onBlur:e.putTaskUpdate},n.a.createElement("option",null,"High"),n.a.createElement("option",null,"Medium"),n.a.createElement("option",null,"Low")),n.a.createElement(c,{deleteTask:e.deleteTask,taskID:t})))};a(87);var h=e=>n.a.createElement("button",{className:"newTaskButton",type:"button",onClick:e.postNewTask},"Add Task");a(88);var u=e=>{const{newTaskTitle:t,handleNewTaskChange:a,postNewTask:s}=e;return n.a.createElement("div",{className:"newTaskForm"},n.a.createElement("form",{onSubmit:e=>{e.preventDefault(),s()}},n.a.createElement("input",{className:"newTaskForm__titleInput",type:"text",placeholder:"Task Title",value:t,onChange:a}),n.a.createElement(h,{postNewTask:s})," "))};a(89);class k extends s.Component{constructor(e){super(),this.state={selected:"Created Date (Descending)"},this.onButtonClick=this.onButtonClick.bind(this),this.onSelectChange=this.onSelectChange.bind(this),this.refactorSelectValue=this.refactorSelectValue.bind(this)}refactorSelectValue(e){const t=e.split("(")[0].trim(),a=e.split("(")[1].replace(/[)]/,"");return{orderByField:{"Created Date":"task_creation_dt","Scheduled Date":"task_scheduled_dt"}[t],direction:a}}onSelectChange(e){const t=e.target.value;this.setState({selected:t})}onButtonClick(){const e=this.state.selected;this.props.sortTasks(this.refactorSelectValue(e))}render(){return n.a.createElement("div",{className:"sortBy"},n.a.createElement("label",{className:"sortBy__label"},"Sort By:",n.a.createElement("select",{className:"sortBy__dropdown",value:this.state.selected,onChange:this.onSelectChange},n.a.createElement("option",null,"Created Date (Descending)"),n.a.createElement("option",null,"Created Date (Ascending)"),n.a.createElement("option",null,"Scheduled Date (Descending)"),n.a.createElement("option",null,"Scheduled Date (Ascending)"))),n.a.createElement("button",{className:"sortBy__button",type:"button",onClick:this.onButtonClick},"Sort"))}}var p=k;a(90);const m=e=>{if(null===e)return null;return Number(e.replace(/[^0-9]/g,""))};var T=a(4);function g(){return n.a.createElement("div",null,n.a.createElement(T.SignedOut,null,n.a.createElement(T.SignInButton,null)),n.a.createElement(T.SignedIn,null,n.a.createElement(T.UserButton,null)))}var E=a(3),y=a.n(E);a(100);var _=e=>{let{onSearchResults:t}=e;const[a,l]=Object(s.useState)("");return n.a.createElement("div",{className:"search-tasks"},n.a.createElement("form",{onSubmit:async e=>{e.preventDefault();try{const e=await fetch("/searchTasks?title="+encodeURIComponent(a));if(!e.ok)throw new Error("Failed to fetch tasks");const s=await e.json();t(s)}catch(s){console.error("Search failed:",s)}}},n.a.createElement("input",{type:"text",placeholder:"Search tasks by title...",value:a,onChange:e=>l(e.target.value)}),n.a.createElement("button",{type:"submit"},"Search")))};class w extends s.Component{constructor(e){super(),this.state={error:null,isFetched:!1,tasks:[],taskOrder:{orderByField:"task_creation_dt",direction:"Descending"},newTaskTitle:""},this.getAllTasks=this.getAllTasks.bind(this),this.putTaskUpdate=this.putTaskUpdate.bind(this),this.handleTaskUpdate=this.handleTaskUpdate.bind(this),this.handleNewTaskChange=this.handleNewTaskChange.bind(this),this.postNewTask=this.postNewTask.bind(this),this.deleteTask=this.deleteTask.bind(this),this.sortTasks=this.sortTasks.bind(this),this.handleSearchResults=this.handleSearchResults.bind(this)}async getAllTasks(e){const{orderByField:t,direction:a}=this.state.taskOrder;try{const e=await fetch("http://localhost:8000/allTasks");if(!e.ok)throw new Error("Failed to fetch tasks: "+e.statusText);const t=await e.json();this.setState({isFetched:!0,tasks:t})}catch(s){this.setState({error:s.message,isFetched:!0}),y.a.error("Failed to fetch tasks. Please try again.")}}handleSearchResults(e){this.setState({tasks:e})}handleTaskUpdate(e){const t=Number(e.target.parentNode.id),a=e.target.name;let s;s="task_completed"===a?e.target.checked:"task_scheduled_dt"===a?""!==e.target.value?e.target.value+"T00:00:00.000Z":null:e.target.value;const n=this.state.tasks.map(e=>e.task_id===t?(e=>{const t=JSON.parse(JSON.stringify(e));return t[a]=s,t})(e):e);this.setState({tasks:n})}putTaskUpdate(e){const t=Number(e.target.parentNode.id),a=e.target.name;let s;if(this.state.tasks.forEach(e=>{e.task_id===t&&(s=e[a])}),"task_scheduled_dt"===a&&""===s&&(s=null),"task_title"===a&&""===s)return;""===s&&"task_scheduled_dt"!==a&&(s="null");const n={taskID:t,fieldName:a,newValue:s},l=y.a.loading("Updating task...");fetch("http://localhost:8000/amendTask",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(e=>{if(200!==e.status)throw new Error("Failed to update task");y.a.success("Task updated successfully",{id:l})}).catch(e=>{console.error("Error updating task:",e),y.a.error("Failed to update task",{id:l})})}async deleteTask(e){if(window.confirm("Are you sure that you want to delete this task?")){const a="http://localhost:8000/deleteTask/"+e,s=y.a.loading("Deleting task...");try{const e=await fetch(a,{method:"DELETE"});if(!e.ok)throw new Error("Failed to delete task: "+e.statusText);this.getAllTasks(!1),y.a.success("Task deleted successfully",{id:s})}catch(t){console.error(t.message),y.a.error("Failed to delete task",{id:s})}}}handleNewTaskChange(e){const t=e.target.value;this.setState({newTaskTitle:t})}async postNewTask(){const{newTaskTitle:e}=this.state;if(!e.trim())return void y.a.error("Task title cannot be empty");const t={taskTitle:e.trim()},a=y.a.loading("Creating new task...");try{const e=await fetch("http://localhost:8000/addTask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){const t=await e.json();throw new Error(t.error||"Failed to create task.")}await e.json();this.setState({newTaskTitle:""}),this.getAllTasks(),y.a.success("Task created successfully",{id:a})}catch(s){console.error("Error creating task:",s.message),y.a.error(s.message||"Failed to create task",{id:a})}}sortTasks(e){const{orderByField:t,direction:a}=e;if(this.state.tasks.every(e=>null===e[t]))return;const s=this.state.tasks.map(e=>e).sort((e,s)=>{const n=m(e[t]),l=m(s[t]);return null===n&&null===l?m(s.task_creation_dt)-m(e.task_creation_dt):null===n?1:null===l?-1:"Ascending"===a?n-l:"Descending"===a?l-n:0});this.setState({tasks:s,taskOrder:{orderByField:t,direction:a}})}componentDidMount(){this.getAllTasks(!1)}render(){const{error:e,isFetched:t}=this.state;if(e)return n.a.createElement("section",null,n.a.createElement("p",null,"Sorry, something went wrong. Please try again."),n.a.createElement(E.Toaster,{position:"top-right"}));if(t){const e=this.state.tasks.map(e=>n.a.createElement(d,{key:e.task_id,task:e,handleTaskUpdate:this.handleTaskUpdate,putTaskUpdate:this.putTaskUpdate,deleteTask:this.deleteTask}));return n.a.createElement("section",{className:"tasksContainer"},n.a.createElement(g,null),n.a.createElement(T.SignedIn,null,n.a.createElement(u,{newTaskTitle:this.state.newTaskTitle,handleNewTaskChange:this.handleNewTaskChange,postNewTask:this.postNewTask}),n.a.createElement(_,{onSearchResults:this.handleSearchResults}),e.length>0?n.a.createElement(p,{sortTasks:this.sortTasks}):null,e,n.a.createElement(E.Toaster,{position:"top-right"})))}return n.a.createElement("section",null,n.a.createElement("p",null,"Your tasks are loading..."),n.a.createElement(E.Toaster,{position:"top-right"}))}}var f=w;var S=()=>n.a.createElement(T.SignedOut,null,n.a.createElement("h2",{style:{margin:"auto"}},"Please log in to continue")),b=a(22);const N="pk_test_aGFyZHktcG9ueS0yMS5jbGVyay5hY2NvdW50cy5kZXYk";const C=Object(b.b)([{children:[{path:"/"},{path:"/sign-in",element:n.a.createElement(S,null)}]}]);r.a.render(n.a.createElement(T.ClerkProvider,{publishableKey:N,afterSignOutUrl:"/sign-in",signInForceRedirectUrl:"/"},n.a.createElement(f,null),n.a.createElement(b.a,{router:C})),document.getElementById("root"))},41:function(e,t,a){e.exports=a(101)},80:function(e,t,a){},81:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){},89:function(e,t,a){},90:function(e,t,a){}},[[41,1,2]]]);
//# sourceMappingURL=main.bf5e71b8.chunk.js.map